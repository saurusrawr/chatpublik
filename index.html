<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Saurus Store</title>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-database-compat.js"></script>
  <style>
    body { 
      margin: 0; font-family: system-ui, sans-serif; 
      background: linear-gradient(135deg, #1e3c72, #2a5298); 
      color: white; min-height: 100vh; overflow-y: auto; 
    }
    .container { padding: 20px; max-width: 100%; margin: 0 auto; }
    h1 { text-align: center; margin: 20px 0; font-size: 2.5rem; }
    .input-box { margin: 20px 0; text-align: center; }
    input { width: 90%; padding: 15px; font-size: 1.2rem; border-radius: 10px; border: none; }
    button { width: 90%; padding: 15px; margin: 10px 0; background: #00b894; color: white; border: none; border-radius: 10px; font-size: 1.2rem; cursor: pointer; }
    .product-list { display: flex; flex-direction: column; gap: 15px; }
    .product { background: rgba(255,255,255,0.15); padding: 15px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .product h3 { margin: 0 0 10px; font-size: 1.4rem; }
    .product p { margin: 5px 0; }
    .buy-btn { background: #e74c3c; color: white; padding: 12px; border: none; border-radius: 10px; width: 100%; font-size: 1.1rem; cursor: pointer; margin-top: 10px; }
    .admin-section { background: rgba(0,0,0,0.5); padding: 20px; border-radius: 15px; margin: 20px 0; }
    .admin-input { margin: 10px 0; }
    .admin-btn { background: #f39c12; }
  </style>
</head>
<body>

<div class="container">

  <!-- Login -->
  <div id="login">
    <h1>Saurus Store</h1>
    <div class="input-box">
      <input type="text" id="nama" placeholder="Masukkan nama kamu...">
      <button onclick="masuk()">Masuk</button>
    </div>
  </div>

  <!-- Dashboard Produk -->
  <div id="dashboard" class="hidden">
    <h1>Selamat Datang, <span id="user-name"></span>!</h1>
    <h2>Daftar Produk</h2>
    <div id="product-list" class="product-list"></div>

    <!-- Admin Panel (hanya muncul kalau owner) -->
    <div id="admin-panel" class="admin-section hidden">
      <h3>Admin Panel</h3>
      <div class="admin-input">
        <input type="text" id="new-nama" placeholder="Nama Produk">
        <input type="number" id="new-harga" placeholder="Harga (contoh: 5000)">
        <button class="admin-btn" onclick="tambahProduk()">Tambah Produk</button>
      </div>
    </div>
  </div>

</div>

<script>
  // Firebase config langsung (sudah diisi dari project kamu)
  const firebaseConfig = {
    apiKey: "AIzaSyBer_DF3-zAyH2rmnMpzilUiE5BYTb4In0",
    authDomain: "saurusproject-6974b.firebaseapp.com",
    databaseURL: "https://saurusproject-6974b-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "saurusproject-6974b",
    storageBucket: "saurusproject-6974b.appspot.com",
    messagingSenderId: "519472343742",
    appId: "1:519472343742:web:xxxxxxxxxxxxxxxx" // Ganti kalau punya appId web
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let namaUser = '';
  let isOwner = false;

  // Login
  function masuk() {
    namaUser = document.getElementById('nama').value.trim();
    if (!namaUser) return alert('Nama wajib diisi!');

    // Cek owner mode rahasia
    isOwner = namaUser.toLowerCase().includes('{khusus:owner}');
    if (isOwner) namaUser = namaUser.replace('{khusus:owner}', '').trim() || 'Owner';

    document.getElementById('login').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    document.getElementById('user-name').textContent = namaUser;

    tampilProduk();

    // Tampil admin panel kalau owner
    if (isOwner) document.getElementById('admin-panel').classList.remove('hidden');
  }

  // Tampil daftar produk dari Firebase
  function tampilProduk() {
    db.ref('products').on('value', snapshot => {
      const list = document.getElementById('product-list');
      list.innerHTML = '';
      const products = snapshot.val() || {};

      Object.keys(products).forEach(key => {
        const p = products[key];
        const div = document.createElement('div');
        div.className = 'product';
        div.innerHTML = `
          <h3>${p.nama}</h3>
          <p>Harga: Rp ${p.harga.toLocaleString('id-ID')}</p>
          <button class="buy-btn" onclick="beli('${p.nama}', ${p.harga})">Beli Sekarang</button>
        `;

        if (isOwner) {
          const editBtn = document.createElement('button');
          editBtn.innerText = 'Edit';
          editBtn.style.background = '#3498db';
          editBtn.style.margin = '5px';
          editBtn.onclick = () => editProduk(key, p.nama, p.harga);
          div.appendChild(editBtn);

          const delBtn = document.createElement('button');
          delBtn.innerText = 'Hapus';
          delBtn.style.background = '#e74c3c';
          delBtn.onclick = () => hapusProduk(key);
          div.appendChild(delBtn);
        }

        list.appendChild(div);
      });
    });
  }

  // Beli produk â†’ pilih WA/Telegram
  function beli(namaProduk, harga) {
    const pilihan = confirm('Pilih metode:\nOK = WhatsApp\nCancel = Telegram');
    const nomor = pilihan ? '62895393336779' : '62895393336779'; // ganti kalau Telegram beda
    const app = pilihan ? 'https://wa.me/' : 'https://t.me/'; // Telegram link contoh
    const pesan = encodeURIComponent(`Hai saurus Aku ${namaUser} Ingin membeli\n${namaProduk} dengan harga ${harga}`);
    window.open(`${app}${nomor}?text=${pesan}`, '_blank');
  }

  // Tambah produk baru (owner)
  function tambahProduk() {
    const nama = document.getElementById('new-nama').value.trim();
    const harga = parseInt(document.getElementById('new-harga').value);
    if (!nama || isNaN(harga)) return alert('Isi nama dan harga dengan benar!');

    const id = db.ref('products').push().key;
    db.ref('products/' + id).set({ nama, harga });
    document.getElementById('new-nama').value = '';
    document.getElementById('new-harga').value = '';
  }

  // Edit produk (owner)
  function editProduk(key, oldNama, oldHarga) {
    const nama = prompt('Nama baru:', oldNama);
    const harga = parseInt(prompt('Harga baru:', oldHarga));
    if (nama && !isNaN(harga)) {
      db.ref('products/' + key).update({ nama, harga });
    }
  }

  // Hapus produk (owner)
  function hapusProduk(key) {
    if (confirm('Yakin hapus produk ini?')) db.ref('products/' + key).remove();
  }
</script>
</body>
</html>
